import { NextRequest, NextResponse } from 'next/server'; import { requireAuth } from '@/lib/session'; import { searchUrl } from '@/lib/snowstorm';
export async function GET(req:NextRequest){ await requireAuth(req); const term=new URL(req.url).searchParams.get('term')||''; const url=searchUrl(term,0,12); if(!url||term.length<2) return NextResponse.json({items:[]}); const r=await fetch(url,{cache:'no-store'}); const j=await r.json(); return NextResponse.json({items:(j.items||[]).map((it:any)=>({id:it.conceptId,term:it.pt?.term||it.fsn?.term||'',fsn:it.fsn?.term||'',active:it.active}))}); }
