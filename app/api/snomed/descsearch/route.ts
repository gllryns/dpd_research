import { NextRequest, NextResponse } from 'next/server'; import { requireAuth } from '@/lib/session'; import { descriptionsUrl } from '@/lib/snowstorm';
export async function GET(req:NextRequest){ await requireAuth(req); const sp=new URL(req.url).searchParams; const term=sp.get('term')||''; const active=(sp.get('active')||'true')!=='false'; const url=descriptionsUrl(term,active,50,0); if(!url||term.length<2) return NextResponse.json({items:[]}); const r=await fetch(url,{cache:'no-store'}); const j=await r.json(); return NextResponse.json({items:(j.items||[]).map((d:any)=>({id:d.concept?.conceptId||d.conceptId,term:d.term,fsn:d.concept?.fsn?.term||d.fsn?.term||'',active:d.active,lang:d.lang||d.languageCode}))}); }
